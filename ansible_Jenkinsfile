pipeline { 
    agent any
    stages {
         stage("Get Env"){
            steps {
               sh "printenv"
            }
        }
        stage("Build Code"){
            steps {
               sh "mvn install"
            }
        }
        stage("Run Unit Tests"){
            steps {
               sh "mvn test"
            }
        }
        
        stage("Prepare - Dev"){
            steps {
                dir ('ansible-deploy'){
                    sh "ansible-playbook tomcat-setup.yml -i hosts"
                    sh "ansible-playbook deploy-spring-boot-hello-world.yml  -e PATH=${WORKSPACE}-i hosts"
                }

            }
               
        }
    }
    post {
        always {
            cleanWs()
        }
    }
}